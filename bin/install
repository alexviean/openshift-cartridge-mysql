#!/bin/bash

source $OPENSHIFT_CARTRIDGE_SDK_BASH
export ICU_VERSION=("58.2" "58_2");
export ICU_MIRROR=http://download.icu-project.org/files/icu4c

### INSTALL ICU

	cd $OPENSHIFT_RUNTIME_DIR
	if [ ! -e dependencies/lib/icu ]; then
		if [ ! -e icu4c-${ICU_VERSION[1]}-src.tgz ]; then
		wget $ICU_MIRROR/${ICU_VERSION[0]}/icu4c-${ICU_VERSION[1]}-src.tgz
		fi
	rm -rf icu
	tar -zxf icu4c-${ICU_VERSION[1]}-src.tgz
	cd icu/source/
	chmod +x runConfigureICU configure install-sh
	./configure --prefix=$OPENSHIFT_RUNTIME_DIR/dependencies/
	make && make install
		if [ $? -eq 0 ]; then
			echo "ICU has successfully been installed!"
			rm -rf $OPENSHIFT_RUNTIME_DIR/icu*
		else
			echo "The installation of ICU has been interrupted."
		fi
	else
		echo "ICU has already been installed!"
	fi

# Output result
client_result "ICU has already been installed!"
